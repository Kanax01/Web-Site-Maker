<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Website Maker</title>
  <link rel="icon" href="favicon.png" type="image/png">
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg-main: #191a1f;
      --bg-panel: #1a1a22;
      --bg-section: #23242a;
      --bg-editor: #181920;
      --text: #f6f6f7;
      --text-title: #e3e3e5;
      --shadow: 0 2px 8px #0005;
      --shadow-section: 0 1px 5px #0003;
      --accent: #3e98fc;
      --radius: 8px;
      --radius-small: 6px;
      --font: 'Segoe UI', Arial, Helvetica, sans-serif;
    }
    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg-main);
      color: var(--text);
      font-family: var(--font);
    }
    body {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
    .app-wrap {
      flex: 1;
      display: flex;
      height: 100vh;
    }
    .editor-panel {
      width: 44vw;
      min-width: 320px;
      max-width: 600px;
      background: var(--bg-panel);
      padding: 1.5rem;
      box-sizing: border-box;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
      overflow-y: auto;
      border-right: 2px solid #16171c;
    }
    .section {
      margin-bottom: 1rem;
      border-radius: var(--radius-small);
      overflow: hidden;
      box-shadow: var(--shadow-section);
      background: var(--bg-section);
    }
    .section-header {
      background: var(--bg-section);
      color: var(--text-title);
      cursor: pointer;
      padding: 0.7rem 1rem;
      display: flex;
      align-items: center;
      user-select: none;
      font-weight: 600;
      font-size: 1.07em;
    }
    .section-header span.arrow {
      font-weight: 900;
      font-size: 20px;
      margin-left: auto;
    }
    .section-content {
      background: var(--bg-editor);
      padding: 0.5rem 0.5rem 0.5rem 1rem;
    }
    .section-content textarea {
      width: 100%;
      min-height: 100px;
      font-family: 'Fira Mono', 'Consolas', monospace;
      background: var(--bg-editor);
      color: var(--text);
      border: 1px solid #23242a;
      border-radius: 4px;
      font-size: 1em;
      resize: vertical;
      box-sizing: border-box;
      transition: border 0.2s;
    }
    .section-content textarea:focus {
      outline: none;
      border: 1.5px solid var(--accent);
      background: #20212b;
    }
    .live-view-panel {
      flex: 1;
      background: var(--bg-main);
      display: flex;
      flex-direction: column;
      align-items: stretch;
      justify-content: flex-start;
    }
    .iframe-wrap {
      flex: 1;
      margin: 2rem;
      margin-top: 0;
      background: #fff;
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      border: 1.5px solid #22232c;
      overflow: hidden;
      min-height: 400px;
      min-width: 300px;
      display: flex;
      flex-direction: column;
      transition: background 0.3s;
      position: relative;
    }
    .titlebar {
      background: var(--bg-panel);
      padding: 1rem 2rem 1rem 1.5rem;
      display: flex;
      align-items: center;
      font-size: 1.5em;
      font-weight: 800;
      letter-spacing: 0.02em;
      color: var(--text-title);
      border-bottom: 1px solid #23242a;
      box-shadow: 0 2px 8px #0002;
      margin-bottom: 0.5rem;
    }
    @media (max-width: 950px) {
      .app-wrap {
        flex-direction: column;
      }
      .editor-panel {
        width: 100vw;
        max-width: none;
        border-right: none;
        border-bottom: 2px solid #16171c;
      }
      .live-view-panel {
        min-height: 300px;
      }
      .iframe-wrap {
        margin: 1rem;
      }
    }
    @media (max-width: 600px) {
      .titlebar {
        font-size: 1.1em;
        padding: 0.8rem 1rem;
      }
      .editor-panel, .iframe-wrap {
        margin: 0.5rem;
        padding: 0.7rem;
      }
    }
  </style>
</head>
<body>
  <div class="titlebar">Website Maker</div>
  <div class="app-wrap">
    <div class="editor-panel">
      <div class="section" id="html-section">
        <div class="section-header" onclick="toggleSection('html')">
          HTML
          <span class="arrow" id="html-arrow">▾</span>
        </div>
        <div class="section-content" id="html-content">
          <textarea id="html-input" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"></textarea>
        </div>
      </div>
      <div class="section" id="css-section">
        <div class="section-header" onclick="toggleSection('css')">
          CSS
          <span class="arrow" id="css-arrow">▾</span>
        </div>
        <div class="section-content" id="css-content">
          <textarea id="css-input" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"></textarea>
        </div>
      </div>
      <div class="section" id="js-section">
        <div class="section-header" onclick="toggleSection('js')">
          JS
          <span class="arrow" id="js-arrow">▾</span>
        </div>
        <div class="section-content" id="js-content">
          <textarea id="js-input" spellcheck="false" autocomplete="off" autocorrect="off" autocapitalize="off"></textarea>
        </div>
      </div>
    </div>
    <div class="live-view-panel">
      <div class="iframe-wrap">
        <iframe id="live-preview" title="Live View" style="width:100%;height:100%;border:none;background:#fff;z-index:1;"></iframe>
      </div>
    </div>
  </div>
  <script>
    // Default content
    const DEFAULT_HTML = `<!-- Start editing HTML here -->\n<div class="container">\n  <h1>Hello, Website Maker!</h1>\n  <p>Edit HTML, CSS, and JS to see changes live.</p>\n</div>`;
    const DEFAULT_CSS = `/* Start editing CSS here */\nbody {\n  background: #fff;\n  color: #222;\n  font-family: 'Segoe UI', sans-serif;\n}\n.container {\n  padding: 1.5rem;\n  background: #f5f5f5;\n  border-radius: 8px;\n  box-shadow: 0 2px 8px #0002;\n}`;
    const DEFAULT_JS = `// Start editing JS here\nconsole.log("Welcome to the Website Maker!");`;

    // Collapsible state
    const collapsed = {
      html: false,
      css: false,
      js: false
    };

    function toggleSection(section) {
      collapsed[section] = !collapsed[section];
      document.getElementById(section + '-content').style.display = collapsed[section] ? 'none' : '';
      document.getElementById(section + '-arrow').textContent = collapsed[section] ? '▸' : '▾';
    }

    // Set up editors
    function setupEditors() {
      // Restore localStorage if available
      const html = localStorage.getItem('wm_html') || DEFAULT_HTML;
      const css = localStorage.getItem('wm_css') || DEFAULT_CSS;
      const js = localStorage.getItem('wm_js') || DEFAULT_JS;
      document.getElementById('html-input').value = html;
      document.getElementById('css-input').value = css;
      document.getElementById('js-input').value = js;
    }

    function getSrcDoc(html, css, js) {
      return `
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <style>
    html, body { background: #fff; color: #222; }
    ${css}
  </style>
</head>
<body>
  ${html}
  <script>
    try {
      ${js}
    } catch(e) {
      document.body.innerHTML += '<pre style="color:#ff5; background:#222; padding:8px; border-radius:4px;">'+e+'</pre>';
    }
  <\/script>
</body>
</html>
      `;
    }

    function updatePreview() {
      // Save the focused element to restore after iframe update
      const active = document.activeElement;

      const html = document.getElementById('html-input').value;
      const css = document.getElementById('css-input').value;
      const js = document.getElementById('js-input').value;
      const srcDoc = getSrcDoc(html, css, js);
      const iframe = document.getElementById('live-preview');
      iframe.srcdoc = srcDoc;

      // Save to localStorage
      localStorage.setItem('wm_html', html);
      localStorage.setItem('wm_css', css);
      localStorage.setItem('wm_js', js);

      // Refocus the textarea if it was focused before
      if (active && (active.id === 'html-input' || active.id === 'css-input' || active.id === 'js-input')) {
        setTimeout(() => active.focus(), 0); // async to avoid browser glitches
      }
    }

    window.addEventListener('DOMContentLoaded', () => {
      setupEditors();
      updatePreview();

      document.getElementById('html-input').addEventListener('input', updatePreview);
      document.getElementById('css-input').addEventListener('input', updatePreview);
      document.getElementById('js-input').addEventListener('input', updatePreview);
    });
  </script>
</body>
</html>
